# Required JavaCard Algorithms

The applets distributed by VivoKey and contained in this repository require hardware support for a range of cryptographic algorithms.

Not all of these algorithms are hard requirements, some applets might provide fallbacks (e.g. for `ALG_HMAC_SHA*`) or limit certain functionality instead (e.g. PGP for generating large key sizes).

The `scripts/algscan.sh` script was used to generate this report.

## Overview

AES:
 - AES sizes 128, 256
 - AES modes CBC, ECB
 - AES paddings ISO9797-M2, None

RSA:
 - RSA sizes 2048, 3072, 4096
 - RSA paddings PKCS#1, None
 - RSA signatures SHA 256
 - RSA signature paddings PKCS1, PKCS1-PSS

SHA:
 - SHA sizes 224, 256, 512
 - SHA signatures ECDSA, RSA
 - SHA paddings PKCS1, PKCS1-PSS, None

EC:
 - EC sizes 256, 384, 521

ECDH:
 - ECDH types Default, Plain, Plain XY

HMAC:
 - HMAC types SHA1, SHA1 (64 block), SHA256

CMAC:
 - CMAC types AES (CMAC 128)
 - CMAC paddings ISO9797-M2, None

MAC:
 - MAC types AES 128
 - MAC paddings None

ECDSA:
 - ECDSA SHA sizes 224, 256, 384, 512

RNG:
 - RNG types Pseudo, True, Secure

## Combined list

```
Cipher.ALG_AES_BLOCK_128_CBC_NOPAD
Cipher.ALG_AES_BLOCK_128_ECB_NOPAD
Cipher.ALG_AES_CBC_ISO9797_M2
Cipher.ALG_RSA_PKCS1
Cipher.CIPHER_AES_CBC, Cipher.PAD_NOPAD
KeyAgreement.ALG_EC_SVDP_DH
KeyAgreement.ALG_EC_SVDP_DH_PLAIN
KeyAgreement.ALG_EC_SVDP_DH_PLAIN_XY
KeyBuilder.ALG_TYPE_AES, JCSystem.MEMORY_TYPE_TRANSIENT_DESELECT, KeyBuilder.LENGTH_AES_128
KeyBuilder.ALG_TYPE_EC_FP_PARAMETERS, JCSystem.MEMORY_TYPE_PERSISTENT, KeyBuilder.LENGTH_EC_FP_256
KeyBuilder.ALG_TYPE_EC_FP_PRIVATE, JCSystem.MEMORY_TYPE_PERSISTENT
KeyBuilder.ALG_TYPE_EC_FP_PRIVATE, JCSystem.MEMORY_TYPE_PERSISTENT, KeyBuilder.LENGTH_EC_FP_256
KeyBuilder.ALG_TYPE_EC_FP_PRIVATE, JCSystem.MEMORY_TYPE_TRANSIENT_DESELECT
KeyBuilder.ALG_TYPE_EC_FP_PRIVATE, JCSystem.MEMORY_TYPE_TRANSIENT_DESELECT, KeyBuilder.LENGTH_EC_FP_256
KeyBuilder.ALG_TYPE_EC_FP_PUBLIC, JCSystem.MEMORY_TYPE_TRANSIENT_DESELECT
KeyBuilder.ALG_TYPE_EC_FP_PUBLIC, JCSystem.MEMORY_TYPE_TRANSIENT_DESELECT, KeyBuilder.LENGTH_EC_FP_256
KeyBuilder.ALG_TYPE_RSA_PRIVATE, JCSystem.MEMORY_TYPE_TRANSIENT_DESELECT, KeyBuilder.LENGTH_RSA_2048
KeyBuilder.ALG_TYPE_RSA_PUBLIC, JCSystem.MEMORY_TYPE_TRANSIENT_DESELECT, KeyBuilder.LENGTH_RSA_2048
KeyBuilder.TYPE_AES_TRANSIENT_DESELECT, KeyBuilder.LENGTH_AES_256
KeyBuilder.TYPE_AES_TRANSIENT_DESELECT, KeyBuilder.LENGTH_AES_256,
KeyBuilder.TYPE_AES, KeyBuilder.LENGTH_AES_128
KeyBuilder.TYPE_AES, KeyBuilder.LENGTH_AES_256
KeyBuilder.TYPE_EC_FP_PRIVATE_TRANSIENT_DESELECT, KeyBuilder.LENGTH_EC_FP_256
KeyBuilder.TYPE_EC_FP_PRIVATE_TRANSIENT_RESET, KeyBuilder.LENGTH_EC_FP_256
KeyBuilder.TYPE_EC_FP_PRIVATE, KeyBuilder.LENGTH_EC_FP_256
KeyBuilder.TYPE_EC_FP_PRIVATE, KeyBuilder.LENGTH_EC_FP_384
KeyBuilder.TYPE_EC_FP_PRIVATE, KeyBuilder.LENGTH_EC_FP_521
KeyBuilder.TYPE_EC_FP_PRIVATE, LENGTH_EC_FP_256
KeyBuilder.TYPE_EC_FP_PUBLIC, KeyBuilder.LENGTH_EC_FP_256
KeyBuilder.TYPE_EC_FP_PUBLIC, KeyBuilder.LENGTH_EC_FP_384
KeyBuilder.TYPE_EC_FP_PUBLIC, KeyBuilder.LENGTH_EC_FP_521
KeyBuilder.TYPE_EC_FP_PUBLIC, LENGTH_EC_FP_256
KeyBuilder.TYPE_HMAC_TRANSIENT_DESELECT, KeyBuilder.LENGTH_AES_256
KeyBuilder.TYPE_HMAC_TRANSIENT_RESET, KeyBuilder.LENGTH_HMAC_SHA_1_BLOCK_64
KeyBuilder.TYPE_RSA_CRT_PRIVATE, KeyBuilder.LENGTH_RSA_2048
KeyBuilder.TYPE_RSA_CRT_PRIVATE, KeyBuilder.LENGTH_RSA_3072
KeyBuilder.TYPE_RSA_CRT_PRIVATE, KeyBuilder.LENGTH_RSA_4096
KeyBuilder.TYPE_RSA_PRIVATE, KeyBuilder.LENGTH_RSA_2048
KeyBuilder.TYPE_RSA_PRIVATE, KeyBuilder.LENGTH_RSA_3072
KeyBuilder.TYPE_RSA_PRIVATE, KeyBuilder.LENGTH_RSA_4096
KeyBuilder.TYPE_RSA_PUBLIC, KeyBuilder.LENGTH_RSA_2048
KeyBuilder.TYPE_RSA_PUBLIC, KeyBuilder.LENGTH_RSA_3072
KeyBuilder.TYPE_RSA_PUBLIC, KeyBuilder.LENGTH_RSA_4096
KeyPair.ALG_EC_FP, KeyBuilder.LENGTH_EC_FP_256
MessageDigest.ALG_NULL, Signature.SIG_CIPHER_AES_CMAC128, Cipher.PAD_ISO9797_M2
MessageDigest.ALG_SHA
MessageDigest.ALG_SHA_224
MessageDigest.ALG_SHA_256
MessageDigest.ALG_SHA_256, Signature.SIG_CIPHER_ECDSA, Cipher.PAD_NULL
MessageDigest.ALG_SHA_256, Signature.SIG_CIPHER_RSA, Cipher.PAD_PKCS1
MessageDigest.ALG_SHA_256, Signature.SIG_CIPHER_RSA, Cipher.PAD_PKCS1_PSS
MessageDigest.ALG_SHA_512
RandomData.ALG_PSEUDO_RANDOM
RandomData.ALG_SECURE_RANDOM
RandomData.ALG_TRNG
Signature.ALG_AES_CMAC_128
Signature.ALG_AES_MAC_128_NOPAD
Signature.ALG_ECDSA_SHA
Signature.ALG_ECDSA_SHA_224
Signature.ALG_ECDSA_SHA_256
Signature.ALG_ECDSA_SHA_384
Signature.ALG_ECDSA_SHA_512
Signature.ALG_HMAC_SHA_512
Signature.ALG_HMAC_SHA1
Signature.ALG_RSA_SHA_256_PKCS1
Signature.ALG_RSA_SHA_256_PKCS1_PSS
```

## Individual applets

### apex-tesla

```
Cipher.ALG_AES_BLOCK_128_ECB_NOPAD
KeyAgreement.ALG_EC_SVDP_DH
KeyBuilder.ALG_TYPE_AES, JCSystem.MEMORY_TYPE_TRANSIENT_DESELECT, KeyBuilder.LENGTH_AES_128
KeyPair.ALG_EC_FP, KeyBuilder.LENGTH_EC_FP_256
```

### apex-totp

```
MessageDigest.ALG_SHA
MessageDigest.ALG_SHA_224
MessageDigest.ALG_SHA_256
RandomData.ALG_PSEUDO_RANDOM
```

### status-keycard

```
Cipher.ALG_AES_CBC_ISO9797_M2
KeyAgreement.ALG_EC_SVDP_DH_PLAIN
KeyAgreement.ALG_EC_SVDP_DH_PLAIN_XY
KeyBuilder.TYPE_AES_TRANSIENT_DESELECT, KeyBuilder.LENGTH_AES_256
KeyBuilder.TYPE_EC_FP_PRIVATE, KeyBuilder.LENGTH_EC_FP_256
KeyBuilder.TYPE_EC_FP_PUBLIC, KeyBuilder.LENGTH_EC_FP_256
KeyBuilder.TYPE_HMAC_TRANSIENT_DESELECT, KeyBuilder.LENGTH_AES_256
KeyPair.ALG_EC_FP, KeyBuilder.LENGTH_EC_FP_256
MessageDigest.ALG_SHA_256
MessageDigest.ALG_SHA_512
RandomData.ALG_SECURE_RANDOM
Signature.ALG_AES_MAC_128_NOPAD
Signature.ALG_ECDSA_SHA_256
Signature.ALG_HMAC_SHA_512
```

### apex-spark

```
Cipher.ALG_AES_BLOCK_128_CBC_NOPAD
Cipher.CIPHER_AES_CBC, Cipher.PAD_NOPAD
KeyBuilder.TYPE_AES, KeyBuilder.LENGTH_AES_128
RandomData.ALG_SECURE_RANDOM
RandomData.ALG_TRNG
```

### u2f-javacard

```
Cipher.ALG_AES_BLOCK_128_CBC_NOPAD
KeyBuilder.TYPE_AES, KeyBuilder.LENGTH_AES_256
KeyBuilder.TYPE_EC_FP_PRIVATE_TRANSIENT_DESELECT, KeyBuilder.LENGTH_EC_FP_256
KeyBuilder.TYPE_EC_FP_PRIVATE_TRANSIENT_RESET, KeyBuilder.LENGTH_EC_FP_256
KeyBuilder.TYPE_EC_FP_PRIVATE, KeyBuilder.LENGTH_EC_FP_256
KeyBuilder.TYPE_EC_FP_PUBLIC, KeyBuilder.LENGTH_EC_FP_256
RandomData.ALG_SECURE_RANDOM
Signature.ALG_ECDSA_SHA_256
```

### apex-fido2

```
Cipher.ALG_AES_BLOCK_128_CBC_NOPAD
Cipher.CIPHER_AES_CBC, Cipher.PAD_NOPAD
KeyAgreement.ALG_EC_SVDP_DH_PLAIN
KeyBuilder.ALG_TYPE_EC_FP_PARAMETERS, JCSystem.MEMORY_TYPE_PERSISTENT, KeyBuilder.LENGTH_EC_FP_256
KeyBuilder.ALG_TYPE_EC_FP_PRIVATE, JCSystem.MEMORY_TYPE_PERSISTENT
KeyBuilder.ALG_TYPE_EC_FP_PRIVATE, JCSystem.MEMORY_TYPE_PERSISTENT, KeyBuilder.LENGTH_EC_FP_256
KeyBuilder.ALG_TYPE_EC_FP_PRIVATE, JCSystem.MEMORY_TYPE_TRANSIENT_DESELECT
KeyBuilder.ALG_TYPE_EC_FP_PRIVATE, JCSystem.MEMORY_TYPE_TRANSIENT_DESELECT, KeyBuilder.LENGTH_EC_FP_256
KeyBuilder.ALG_TYPE_EC_FP_PUBLIC, JCSystem.MEMORY_TYPE_TRANSIENT_DESELECT
KeyBuilder.ALG_TYPE_EC_FP_PUBLIC, JCSystem.MEMORY_TYPE_TRANSIENT_DESELECT, KeyBuilder.LENGTH_EC_FP_256
KeyBuilder.ALG_TYPE_RSA_PRIVATE, JCSystem.MEMORY_TYPE_TRANSIENT_DESELECT, KeyBuilder.LENGTH_RSA_2048
KeyBuilder.ALG_TYPE_RSA_PUBLIC, JCSystem.MEMORY_TYPE_TRANSIENT_DESELECT, KeyBuilder.LENGTH_RSA_2048
KeyBuilder.TYPE_AES_TRANSIENT_DESELECT, KeyBuilder.LENGTH_AES_256,
KeyBuilder.TYPE_AES, KeyBuilder.LENGTH_AES_256
KeyBuilder.TYPE_EC_FP_PRIVATE, KeyBuilder.LENGTH_EC_FP_256
KeyBuilder.TYPE_EC_FP_PUBLIC, KeyBuilder.LENGTH_EC_FP_256
KeyBuilder.TYPE_RSA_PRIVATE, KeyBuilder.LENGTH_RSA_2048
KeyBuilder.TYPE_RSA_PUBLIC, KeyBuilder.LENGTH_RSA_2048
MessageDigest.ALG_SHA_256
MessageDigest.ALG_SHA_256, Signature.SIG_CIPHER_ECDSA, Cipher.PAD_NULL
MessageDigest.ALG_SHA_256, Signature.SIG_CIPHER_RSA, Cipher.PAD_PKCS1
MessageDigest.ALG_SHA_256, Signature.SIG_CIPHER_RSA, Cipher.PAD_PKCS1_PSS
RandomData.ALG_SECURE_RANDOM
RandomData.ALG_TRNG
Signature.ALG_ECDSA_SHA_256
Signature.ALG_RSA_SHA_256_PKCS1
Signature.ALG_RSA_SHA_256_PKCS1_PSS
```

### SatochipApplet

```
Cipher.ALG_AES_BLOCK_128_CBC_NOPAD
Cipher.ALG_AES_BLOCK_128_ECB_NOPAD
KeyAgreement.ALG_EC_SVDP_DH_PLAIN_XY
KeyBuilder.TYPE_AES, KeyBuilder.LENGTH_AES_128
KeyBuilder.TYPE_AES, KeyBuilder.LENGTH_AES_256
KeyBuilder.TYPE_EC_FP_PRIVATE, LENGTH_EC_FP_256
KeyBuilder.TYPE_EC_FP_PUBLIC, LENGTH_EC_FP_256
MessageDigest.ALG_SHA
MessageDigest.ALG_SHA_256
MessageDigest.ALG_SHA_512
RandomData.ALG_SECURE_RANDOM
```

### FIDO2Applet

```
Cipher.ALG_AES_BLOCK_128_CBC_NOPAD
KeyAgreement.ALG_EC_SVDP_DH_PLAIN
KeyBuilder.TYPE_AES_TRANSIENT_DESELECT, KeyBuilder.LENGTH_AES_256
KeyBuilder.TYPE_AES, KeyBuilder.LENGTH_AES_256
KeyBuilder.TYPE_EC_FP_PRIVATE_TRANSIENT_DESELECT, KeyBuilder.LENGTH_EC_FP_256
KeyBuilder.TYPE_EC_FP_PRIVATE_TRANSIENT_RESET, KeyBuilder.LENGTH_EC_FP_256
KeyBuilder.TYPE_EC_FP_PRIVATE, KeyBuilder.LENGTH_EC_FP_256
KeyBuilder.TYPE_EC_FP_PUBLIC, KeyBuilder.LENGTH_EC_FP_256
MessageDigest.ALG_SHA_256
RandomData.ALG_SECURE_RANDOM
Signature.ALG_ECDSA_SHA_256
```

### apex-ndef

```
KeyBuilder.TYPE_AES, KeyBuilder.LENGTH_AES_128
MessageDigest.ALG_NULL, Signature.SIG_CIPHER_AES_CMAC128, Cipher.PAD_ISO9797_M2
Signature.ALG_AES_CMAC_128
```

### SmartPGP

```
Cipher.ALG_AES_BLOCK_128_CBC_NOPAD
Cipher.ALG_RSA_PKCS1
KeyAgreement.ALG_EC_SVDP_DH_PLAIN
KeyBuilder.TYPE_AES, KeyBuilder.LENGTH_AES_128
KeyBuilder.TYPE_AES, KeyBuilder.LENGTH_AES_256
KeyBuilder.TYPE_EC_FP_PRIVATE, KeyBuilder.LENGTH_EC_FP_256
KeyBuilder.TYPE_EC_FP_PRIVATE, KeyBuilder.LENGTH_EC_FP_384
KeyBuilder.TYPE_EC_FP_PRIVATE, KeyBuilder.LENGTH_EC_FP_521
KeyBuilder.TYPE_EC_FP_PUBLIC, KeyBuilder.LENGTH_EC_FP_256
KeyBuilder.TYPE_EC_FP_PUBLIC, KeyBuilder.LENGTH_EC_FP_384
KeyBuilder.TYPE_EC_FP_PUBLIC, KeyBuilder.LENGTH_EC_FP_521
KeyBuilder.TYPE_RSA_CRT_PRIVATE, KeyBuilder.LENGTH_RSA_2048
KeyBuilder.TYPE_RSA_CRT_PRIVATE, KeyBuilder.LENGTH_RSA_3072
KeyBuilder.TYPE_RSA_CRT_PRIVATE, KeyBuilder.LENGTH_RSA_4096
KeyBuilder.TYPE_RSA_PRIVATE, KeyBuilder.LENGTH_RSA_2048
KeyBuilder.TYPE_RSA_PRIVATE, KeyBuilder.LENGTH_RSA_3072
KeyBuilder.TYPE_RSA_PRIVATE, KeyBuilder.LENGTH_RSA_4096
KeyBuilder.TYPE_RSA_PUBLIC, KeyBuilder.LENGTH_RSA_2048
KeyBuilder.TYPE_RSA_PUBLIC, KeyBuilder.LENGTH_RSA_3072
KeyBuilder.TYPE_RSA_PUBLIC, KeyBuilder.LENGTH_RSA_4096
RandomData.ALG_SECURE_RANDOM
Signature.ALG_ECDSA_SHA
Signature.ALG_ECDSA_SHA_224
Signature.ALG_ECDSA_SHA_256
Signature.ALG_ECDSA_SHA_384
Signature.ALG_ECDSA_SHA_512
```

### flexsecure-ykhmac

```
KeyBuilder.TYPE_HMAC_TRANSIENT_RESET, KeyBuilder.LENGTH_HMAC_SHA_1_BLOCK_64
MessageDigest.ALG_SHA
RandomData.ALG_SECURE_RANDOM
Signature.ALG_HMAC_SHA1
```

### Satodime-Applet

```
Cipher.ALG_AES_BLOCK_128_CBC_NOPAD 
Cipher.ALG_AES_BLOCK_128_ECB_NOPAD
KeyAgreement.ALG_EC_SVDP_DH_PLAIN_XY
KeyBuilder.TYPE_AES, KeyBuilder.LENGTH_AES_128
KeyBuilder.TYPE_EC_FP_PRIVATE, LENGTH_EC_FP_256
KeyBuilder.TYPE_EC_FP_PUBLIC, LENGTH_EC_FP_256 
MessageDigest.ALG_SHA
MessageDigest.ALG_SHA_256
RandomData.ALG_SECURE_RANDOM
```

### Seedkeeper-Applet

```
Cipher.ALG_AES_BLOCK_128_CBC_NOPAD
Cipher.ALG_AES_BLOCK_128_ECB_NOPAD
KeyAgreement.ALG_EC_SVDP_DH_PLAIN_XY
KeyBuilder.TYPE_AES, KeyBuilder.LENGTH_AES_128
KeyBuilder.TYPE_EC_FP_PRIVATE, LENGTH_EC_FP_256
KeyBuilder.TYPE_EC_FP_PUBLIC, LENGTH_EC_FP_256
MessageDigest.ALG_SHA
MessageDigest.ALG_SHA_256
MessageDigest.ALG_SHA_512
RandomData.ALG_SECURE_RANDOM
```

## Sources and Further Reading

- https://docs.oracle.com/javase/7/docs/api/javax/crypto/package-summary.html

Improve this document: https://github.com/DangerousThings/flexsecure-applets/tree/master/docs
